// SPDX-License-Identifier: (GPL-2.0-or-later OR MIT)
/*
 * Copyright Zhaolaibin's SX-7981R128 Update By nanchuci
 */

/dts-v1/;
#include "mt7981-spim-nand-7981rxxx.dtsi"

/ {
	model = "7981R128";
	compatible = "mediatek,mt7981-spim-snand-7981r128";

	leds {
		compatible = "gpio-leds";

		SFP: sfp {
			label = "SFP";
			gpios = <&pio 4 GPIO_ACTIVE_LOW>;
			default-state = "off";
		};

		WIFI5G: wifi5g {
			label = "WIFI5G";
			gpios = <&pio 5 GPIO_ACTIVE_LOW>;
			default-state = "off";
		};

		WIFI2G: wifi2g {
			label = "WIFI2G";
			gpios = <&pio 6 GPIO_ACTIVE_LOW>;
			default-state = "off";
		};

		LAN: lan {
			label = "LAN";
			gpios = <&pio 8 GPIO_ACTIVE_LOW>;
			default-state = "off";
		};

		POWER: power {
			label = "POWER";
			gpios = <&pio 13 GPIO_ACTIVE_LOW>;
			default-state = "on";
		};
	};

	sfp1: sfp-wan {
		compatible = "sff,sfp";
		i2c-bus = <&i2c_sfp1>;
		los-gpios = <&pio 3 GPIO_ACTIVE_HIGH>;
		mod-def0-gpios = <&pio 35 GPIO_ACTIVE_LOW>;
		tx-disable-gpios = <&pio 12 GPIO_ACTIVE_HIGH>;
		tx-fault-gpios = <&pio 34 GPIO_ACTIVE_HIGH>;
		maximum-power-milliwatt = <3000>;
	};
};

&eth {
	status = "okay";

	gmac0: mac@0 {
		compatible = "mediatek,eth-mac";
		reg = <0>;
		phy-mode = "2500base-x";

		fixed-link {
			speed = <2500>;
			full-duplex;
			pause;
		};
	};

	gmac1: mac@1 {
		compatible = "mediatek,eth-mac";
		reg = <1>;
		phy-mode = "2500base-x";
		managed = "in-band-status";
		sfp = <&sfp1>;
	};

	mdio: mdio-bus {
		#address-cells = <1>;
		#size-cells = <0>;

		phy5: phy@5 {
			/* Intel GPY211 (SLNW8) */
			compatible = "ethernet-phy-id67c9.de0a";
			/* GPY211 Address */
			reg = <5>;
			reset-gpios = <&pio 7 GPIO_ACTIVE_LOW>;
			reset-assert-us = <600>;
			reset-deassert-us = <20000>;
			phy-mode = "2500base-x";
			maxlinear,led-drive-vdd;
			maxlinear,led-reg = <0x3c0 0x330 0x3f 0x0>;
			label = "lan2";
		};

		switch@0 {
			compatible = "mediatek,mt7531";
			reg = <31>;
			reset-gpios = <&pio 39 0>;

			ports {
				#address-cells = <1>;
				#size-cells = <0>;

				port@1 {
					reg = <1>;
					label = "lan1";
				};

				port@5 {
					reg = <5>;
					label = "lan2";
					phy-mode = "2500base-x";
					phy-handle = <&phy5>;
				};

				port@6 {
					reg = <6>;
					label = "cpu";
					ethernet = <&gmac0>;
					phy-mode = "2500base-x";

					fixed-link {
						speed = <2500>;
						full-duplex;
						pause;
					};
				};
			};
		};
	};
};

&hnat {
	mtketh-wan = "eth1";
	mtketh-lan = "lan";
	mtketh-max-gmac = <2>;
	ext-devices-prefix = "usb", "wwan", "rmnet";
	status = "okay";
};
