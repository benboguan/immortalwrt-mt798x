--- a/iwlist.c
+++ b/iwlist.c
@@ -158,6 +158,22 @@ print_scanning_info(int		skfd,
 	"none",
 	"802.1x",
 	"PSK",
+	"FT_802.1x",
+	"FT_PSK",
+	"802.1x_SHA256",
+	"PSK_SHA256",
+	"TPK_HANDSHAKE",
+	"SAE",
+	"FT_OVER_SAE",
+	"undefined-1",
+	"802.1x_SUITE_B",
+	"802.1x_SUITE_B_192",
+	"undefined-2",
+	"FILS_SHA256",
+	"FILS_SHA384",
+	"FT_FILS_SHA256",
+	"FT_FILS_SHA384",
+	"OWE",
 };
 #define	IW_IE_KEY_MGMT_NUM	IW_ARRAY_LEN(iw_ie_key_mgmt_name)
 
@@ -792,7 +808,8 @@ print_scanning_info(int		skfd,
 	  if(iw_get_ext(skfd, ifname, SIOCGIWSCAN, &wrq) < 0)
 	    {
 	      /* Check if buffer was too small (WE-17 only) */
-	      if((errno == E2BIG) && (range.we_version_compiled > 16))
+	      if((errno == E2BIG) && (range.we_version_compiled > 16)
+	         && (buflen < 0xFFFF))
 		{
 		  /* Some driver may return very large scan results, either
 		   * because there are many cells, or because they have many
@@ -808,6 +825,10 @@ print_scanning_info(int		skfd,
 		  else
 		    buflen *= 2;
 
+                 /* wrq.u.data.length is 16 bits so max size is 65535 */
+                 if(buflen > 0xFFFF)
+                   buflen = 0xFFFF;
+
 		  /* Try again */
 		  goto realloc;
 		}
@@ -2152,6 +2173,7 @@ main(int	argc,
   char **args;			/* Command arguments */
   int count;			/* Number of arguments */
   const iwlist_cmd *iwcmd;
+  int goterr = 0;
 
   if(argc < 2)
     iw_usage(1);
@@ -2199,12 +2221,12 @@ main(int	argc,
 
   /* do the actual work */
   if (dev)
-    (*iwcmd->fn)(skfd, dev, args, count);
+    goterr = (*iwcmd->fn)(skfd, dev, args, count);
   else
     iw_enum_devices(skfd, iwcmd->fn, args, count);
 
   /* Close the socket. */
   iw_sockets_close(skfd);
 
-  return 0;
+  return goterr;
 }
